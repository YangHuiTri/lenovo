!function(a){"use strict";var b,c=a.Base64,d="2.1.8";"undefined"!=typeof module&&module.exports&&(b=require("buffer").Buffer);var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(a){for(var b={},c=0,d=a.length;c<d;c++)b[a.charAt(c)]=c;return b}(e),g=String.fromCharCode,h=function(a){if(a.length<2){var b=a.charCodeAt(0);return b<128?a:b<2048?g(192|b>>>6)+g(128|63&b):g(224|b>>>12&15)+g(128|b>>>6&63)+g(128|63&b)}var b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return g(240|b>>>18&7)+g(128|b>>>12&63)+g(128|b>>>6&63)+g(128|63&b)},i=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,j=function(a){return a.replace(i,h)},k=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0),d=[e.charAt(c>>>18),e.charAt(c>>>12&63),b>=2?"=":e.charAt(c>>>6&63),b>=1?"=":e.charAt(63&c)];return d.join("")},l=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,k)},m=b?function(a){return(a.constructor===b.constructor?a:new b(a)).toString("base64")}:function(a){return l(j(a))},n=function(a,b){return b?m(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):m(String(a))},o=function(a){return n(a,!0)},p=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),q=function(a){switch(a.length){case 4:var b=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),c=b-65536;return g((c>>>10)+55296)+g((1023&c)+56320);case 3:return g((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return g((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(p,q)},s=function(a){var b=a.length,c=b%4,d=(b>0?f[a.charAt(0)]<<18:0)|(b>1?f[a.charAt(1)]<<12:0)|(b>2?f[a.charAt(2)]<<6:0)|(b>3?f[a.charAt(3)]:0),e=[g(d>>>16),g(d>>>8&255),g(255&d)];return e.length-=[0,0,2,1][c],e.join("")},t=a.atob?function(b){return a.atob(b)}:function(a){return a.replace(/[\s\S]{1,4}/g,s)},u=b?function(a){return(a.constructor===b.constructor?a:new b(a,"base64")).toString()}:function(a){return r(t(a))},v=function(a){return u(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var b=a.Base64;return a.Base64=c,b};if(a.Base64={VERSION:d,atob:t,btoa:l,fromBase64:v,toBase64:n,utob:j,encode:n,encodeURI:o,btou:r,decode:v,noConflict:w},"function"==typeof Object.defineProperty){var x=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",x(function(){return v(this)})),Object.defineProperty(String.prototype,"toBase64",x(function(a){return n(this,a)})),Object.defineProperty(String.prototype,"toBase64URI",x(function(){return n(this,!0)}))}}a.Meteor&&(Base64=a.Base64)}(this),function(a,b,c){a[b]=c()}(this,"Util",function(){return{cookie:{get:function(a){var b,c=document.cookie,d=c.indexOf(a+"="),e=c.indexOf(";",d);return e==-1&&(e=c.length),d>-1?b=c.substring(d+a.length+1,e):null},set:function(a,b,c,d,e){var e=e||"/",f="";if(c){var g=new Date;g.setTime(g.getTime()+1e3*c),f="expires="+g.toGMTString()}document.cookie=a+"="+b+";"+f+";"+(d?"domain="+d:"")+";path="+e},remove:function(a,b,c){this.set(a,"",-1,b,c)}},parseURI:function(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null},absolutizeURI:function(a,b){function c(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return b=Util.parseURI(b||""),a=Util.parseURI(a||""),b&&a?(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority)+c(b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname)+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash:null},getDomain:function(a){var b=/\/\/([^\/]+)/.exec(a)[1],c=b.split(".").slice(-3);return/lenovouat/.test(a)?/tks\.lenovouat\.cn/.test(b)?"tks.lenovouat.cn":/tk\.lenovouat\.cn/.test(b)?"tk.lenovouat.cn":/vip\.lenovouat\.cn/.test(b)?"vip.lenovouat.cn":"lenovouat.cn":2==c.length?b:"com"==c[1]?c.join("."):c[1]+"."+c[2]},loadCSS:function(a,b){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href=a,document.getElementsByTagName("head")[0].appendChild(c),c.onload=c.onreadystatechange=function(){this.readyState&&!/loaded|complete/.test(this.readyState)||(b&&b(),c.onload=c.onreadystatechange=null)}},loadJS:function(a,b,c){var d=document.createElement("script");d.type="text/javascript",d.src=a,d.onload=d.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(b&&"function"==typeof b&&b(),this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this))},d.onerror=function(){c&&"function"==typeof c&&c(),d.onerror=null},document.getElementsByTagName("head")[0].appendChild(d)},simulatePlaceholder:function(a,b,c){var c=c||$("body"),b=b||"placeholder",d=$(document.createElement("div")),e=a.position(),f=a.width(),g=a.outerHeight()+1;return d.addClass(b).css({lineHeight:g+"px",width:f+"px",height:g+"px",left:e.left+"px",top:e.top+"px"}).html(a.attr("data-placeholder")),c.append(d),a.on("keyup",function(){""!=a.val()?d.hide():d.show()}).on("blur",function(){""!=a.val()?d.hide():d.show()}).on("focus",function(){""!=a.val()?d.hide():d.show()}),d.on("click",function(){a.focus()}),d},simulateFormSubmit:function(a,b,c,d){var e=[],f=!1;$("body").append('<iframe class="iframeBridge" style="display: none;" name="iframeBridge"></iframe>'),e.push('<form class="simulateForm" style="display: none" target="iframeBridge" method="post" action="'+a+'">'),$.each(b,function(a,b){b&&e.push('<input name="'+a+'" value="'+b+'" type="hidden"/>')}),e.push("</form>"),$("body").append(e.join("")),$(".simulateForm").submit().remove(),$(".iframeBridge").removeAttr("name"),$(".iframeBridge").on("load",function(){var a=new Function("return "+this.contentWindow.name)();$(".iframeBridge").remove(),f=!0,clearTimeout(g),c&&c(a)});var g=setTimeout(function(){return f?void clearTimeout(g):($(".iframeBridge").remove(),void(d&&d()))},2e4)},formPostSubmit:function(a,b,c){var d=[],e=!1;$("body").append('<iframe class="iframepost" style="display:none;" name="iframepost"></iframe>'),d.push('<form class="postForm" style="display:none;" target="iframepost" method="post" action="'+a+'">'),$.each(b,function(a,b){b&&d.push('<input name="'+a+'" value="'+b+'" type="hidden"/>')}),d.push("</form>"),$("body").append(d.join("")),$(".postForm").submit().remove(),$(".iframepost").on("load",function(){try{var a=new Function("return "+this.contentWindow.name)();$(this).remove(),e=!0,clearTimeout(f),c&&c(a)}catch(b){c&&c({})}});var f=setTimeout(function(){return e?void clearTimeout(f):void $(".iframepost").remove()},2e3)}}}),!function(a,b,c){a[b]=c()}(this,"LenovoId",function(){return{lidlogin:function(a,b){var c={lpstgt:a,username:b,state:"login",realm:"shop.lenovo.com.cn"};window.Util.formPostSubmit(location.protocol+"//passport.lenovo.com/wauthen2/tgtAccess",c,function(){})},lidlogout:function(a){var b={lpstgt:"",username:a,state:"logout",realm:"shop.lenovo.com.cn"};window.Util.formPostSubmit(location.protocol+"//passport.lenovo.com/wauthen2/tgtAccess",b,function(){})}}}),!function(a,b){this[a]=b()}("Class",function(){var a=function(a){return/\s(\w+)/.exec(Object.prototype.toString.call(a).toLowerCase())[1]},b=function(a){for(key in a)this[key]=a[key];return this},c=function(c,d){var e,f=a(c),g=a(d);c="function"==f?[c]:"object"==f?(e=c)&&[c.constructor||function(){}]:[function(){}],e&&delete e.constructor,d="function"==g?(c=c.concat(d.constructor||d))&&d.prototype:"object"==g?d:null,e&&!d?(d=e,e=null):d=d||{},d.extended||(d.extended=b);var h=function(){e&&b.call(this,e)};h.prototype=d;var i=function(){for(var a=c.length,b=a-1;b>=0;b--)c[b].apply(this,arguments)};return i.constructor=c[0],i.prototype=new h,i.extended=function(d){return d.extended=d.extended||b,c=[this.constructor],this.prototype=d,"function"==a(d)&&(c=c.concat(d.constructor||d),this.prototype=d.prototype),this},i.implemented=function(a){this.prototype=(new h).extended(a)},i},d={};return d.create=c,d});var getPosition=function(a,b){for(var c=y=0,b=b||document.body;a!=b;)c+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent;return{x:c,y:y}},AutoComplete=Class.create({constructor:function(a){var b,c="keyup";if(this.tip=a.tip||"Please input the keywords",this.input=a.input,this.input){if(this.form=a.form,!this.form&&(b=this.input.parents("form"))&&b.length&&(this.form=b,b=null),this.submit=a.submit||this.submit,this.getDatas=a.getDatas||this.getDatas,this.suggest=a.suggest&&a.suggest.length?a.suggest:null,!this.suggest){var d=this.input.parent(),e=document.createElement("div");d.css("position","relative");var f=getPosition(this.input[0],d[0]).x,g=this.input.width(),h=getPosition(this.input[0],d[0]).y+this.input.height();e.style.cssText="top:"+h+"px;left:"+f+"px;width:"+g+"px;",e.className="suggest",d.append(e),this.suggest=jQuery(e)}this.suggest.hide(),this.list=(a.list||"li").toLowerCase(),this.hover=a.hover||"hover",this.input.attr("data-placeholder")||(this.input.val(this.tip),this.input.focus(jQuery.proxy(this.focus,this))),this.input.blur(jQuery.proxy(this.blur,this)),this.input.keydown(jQuery.proxy(this.keydown,this)),this.input.bind(c,jQuery.proxy(this.textInput,this)),this.form&&this.form.bind("submit",jQuery.proxy(this.submit,this)),this.suggest.delegate(this.list,"mouseover",jQuery.proxy(this.mouseover,this)),this.suggest.delegate(this.list,"click",jQuery.proxy(this.click,this))}},focus:function(){this.input.val()==this.tip&&this.input.val("")},blur:function(){var a=this;this.input.attr("data-placeholder")||""!=this.input.val()||this.input.val(this.tip),setTimeout(function(){a.suggest.hide(),a.current=null},500)},setInputValue:function(a){var b,c=this.list;this.current||(this.current=this.suggest.find(c).first()),b=this.current.attr("title")||this.current.text(),this.input.val(b)},click:function(){this.setInputValue(),this.suggest.hide()},submit:function(a){this.form&&a.preventDefault()},keydown:function(a){var b=a.keyCode,c=this.list,d=this.hover;if(38==b||40==b){if(!this.suggest.find(c).length)return;a.preventDefault(),this.current&&this.current.removeClass(d),38==b?this.current=this.current&&this.current.prev().length?this.current.prev():this.suggest.find(c).last():this.current=this.current&&this.current.next().length?this.current.next():this.suggest.find(c).first(),this.current.addClass(d),this.setInputValue()}else 13==b&&(this.setInputValue(),this.form||this.submit())},getDatas:function(){throw new Error('Method ".getDatas()" is needed.')},textInput:function(a){var b=a.keyCode;(!b||b>=48&&b<=90||b>=96&&b<=105||8==b||32==b||45==b)&&this.getDatas()},mouseover:function(a){for(var b=a.target;b&&b.nodeName.toLowerCase()!=this.list;)b=b.parentNode;b.nodeName.toLowerCase()==this.list&&(this.current&&this.current.removeClass(this.hover),this.current=jQuery(b),this.current.addClass(this.hover))}});!function(a,b,c){a[b]=c()}(this,"passport",function(){var a=window.jQuery,b=window.Util,c=window.LenovoId;if(window.sum=0,window.getMobileCode=function(a){a.ret;"0"!=a.ret&&(i.html(a.msg),d.select())},window.doFastLogin=function(c){var d=c.ret;if("0"==d){var e=b.getDomain(z.loginRedirect||document.URL),f=encodeURIComponent(c["cerpreg-passprt"]);/lenovo\.com\.cn|lenovouat\.cn/.test(e)?(b.cookie.set("ar","2"),v(f)):a.getScript("//reg."+e+"/auth/set_cookie?cookie="+f+"&domain="+e+"&ar=2",function(){v(f)})}else i.html(c.msg)},window.lVETEbVhueFZZkIHgsuausYSIksjdUYSHYjslkOISUhsSKUFDIUASDsaiISUAYSDs=function(b,c,d,e,f){a.getScript("https://reg.lenovo.com.cn"+"/auth/v3/synlogin?tk="+z.ticket+"&ts="+e+"&callback=fECS")},window.fECS=function(c){var d=c.ret,e=b.getDomain(document.URL);if("0"==d){var f=encodeURIComponent(c["cerpreg-passport"]);a.getScript("//reg."+e+"/auth/set_cookie?cookie="+f+"&domain="+e,function(){try{p(),z.drawUserInfo()}catch(a){}x(f)})}},!a)throw new Error("未加载jQuery框架");var d,e,f,g,h,i,j,k=/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i,l=!1,m=0,n=function(a){switch(a){case 1:throw new Error("多次初始化,请避免");case 2:throw new Error("passport初始化少参数");case 3:throw new Error("WARNING:!!!shitJump，dangerous!!!");case 4:throw new Error("非法请求")}},o=function(){a("#ppMask").length||a("body").append('<div id="ppMask" class="ppMask"></div>')},p=function(){if(!z.cookie){var a=unescape(b.cookie.get("cerpreg-passport"));if(a){var c=a.split("|"),d=c[4];if(c&&d){var e=decodeURIComponent(unescape(Base64.decode(d))),f=e.split("|");z.cookie={};for(var g=0;g<f.length;g++){var h=f[g].split(":"),i=h[0],j=h[2];z.cookie[i]=j}}}}},q=function(){var b=z.ticket,c=encodeURIComponent(document.URL),d=[];d.push('<div class="ppWrapper" id="ppWrapper">'),d.push('<div class="login_pp">'),d.push('<div class="login_title"> <h3 class="now" type="0" latag="latag_pc_login_normal">普通登录</h3><h3 type="1" latag="latag_pc_login_quick">快捷登录</h3> <a class="close" href="javascript:void(0)" latag="latag_pc_login_boxclose"></a></div>'),d.push('<div class="login_inputa"> <div class="img"> <img src="//m1.lefile.cn/lenovo_passport/0.4.9/images/icon03.jpg"> </div>      <input class="account" type="text" data-placeholder="请输入手机号或邮箱"> <input class="m_account" style="display:none;" type="text"  data-placeholder="请输入手机号"></div>'),d.push('<div class="login_inputb"> <div class="imgs"> <img src="//m2.lefile.cn/lenovo_passport/0.4.9/images/icon04.jpg"> </div><button class="getMobileCode" style="display:none;" latag="latag_pc_login_getMobileCode">获取动态密码</button> <input class="pwd" type="password" data-placeholder="密码">  <input class="mcode" style="display:none;" type="text" data-placeholder="动态密码"></div>'),d.push('<div class="captcha_wrapper" style="display: none;"><input class="captcha" type="text" data-placeholder="请输入验证码"/><img class="captcha_img" /><span class="captcha_tip">换一换</span></div>'),d.push('<div class="login_main"> <p class="tip"></p> </div>'),d.push('<div class="login_mains"><label> <input class="persistent" checked type="checkbox" latag="latag_pc_login_autologin"> <p>自动登录</p></label> </div>'),d.push('<div class="login_btn"> <a href="javascript:void(0)" class="submit" latag="latag_pc_login_confirm">登&nbsp;&nbsp;录</a> </div>'),d.push('<div class="login_footer"><p><a class="regist" href="javascript:void(0)" latag="latag_pc_login_register">立即注册</a><a href="javascript:void(0)" class="forgetPwd" latag="latag_pc_login_forgetpw">忘记密码</a></p> </div>'),d.push('<div class="cooperation">使用合作网站账号登录:<div class="cooperation_items"><a class="qq" href="//'+"reg.lenovo.com.cn"+"/auth/qqplat?ru="+c+"&tk="+b+'" latag="latag_pc_login_qq"><image title="QQ登录" alt="QQ登录" src="//m1.lefile.cn/lenovo_passport/0.4.9/images/ico_qq.png"/></a><a class="weibo" href="//'+"reg.lenovo.com.cn"+"/auth/sinaplat?ru="+c+"&tk="+b+'" latag="latag_pc_login_weibo"><img alt="微博登录" title="微博登录" src="//m2.lefile.cn/lenovo_passport/0.4.9/images/ico_sina.png" /></a><a latag="latag_pc_login_wechat" href="//'+"reg.lenovo.com.cn"+"/auth/wechatcode?ru="+c+"&tk="+b+'" class="wechat"><img src="//m2.lefile.cn/lenovo_passport/0.4.9/images/ico_wc.png" title="微信登录" alt="微信登录"></a><a class="zfb" href="//'+"reg.lenovo.com.cn"+"/auth/alipayplat?ru="+c+"&tk="+b+'" latag="latag_pc_login_zfb"><img alt="支付宝登录" title="支付宝登录" src="//m1.lefile.cn/lenovo_passport/0.4.9/images/ico_zfb.png"></a></div></div>'),d.push("</div>"),d.push("</div>"),d.push('<div class="suggest"></div>'),a("body").append(d.join("")),z.rootElement=a("#ppWrapper")},r=function(){new AutoComplete({input:d,suggest:a(".suggest"),getDatas:function(){var b=d.val(),c=b.split("@"),e=c[0],f=c[1]||"",g=["163.com","qq.com","126.com","sohu.com","sina.com"],h=[];return""==b?(this.current=null,void this.suggest.hide().html("")):(h.push('<li class="hover">'+b+"</li>"),""!=f&&0=="lenovo".indexOf(f)&&g.unshift("lenovo.com"),a.each(g,function(){this.indexOf(f)>-1&&h.push("<li>"+e+"@"+this+"</li>")}),this.suggest.html("<ul>"+h.join("")+"</ul>").show(),void(this.current=this.suggest.find("li").first()))},submit:function(){this.suggest.hide()}})},s=function(){d=z.rootElement.find(".account"),e=z.rootElement.find(".m_account"),f=z.rootElement.find(".pwd"),mcode=z.rootElement.find(".mcode"),g=z.rootElement.find(".captcha"),h=z.rootElement.find(".captcha_img"),i=z.rootElement.find(".tip"),j=z.rootElement.find(".submit"),z.rootElement.delegate("h3","click",function(){var c=a(this).attr("type");m=c,i.html(""),a(this).siblings().removeClass("now"),a(this).addClass("now"),"0"==c?(k=/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i,mcode.hide(),e.hide(),a(".getMobileCode").hide(),d.val("").show().focus(),f.val("").show(),a(".m_account_placeholder,.mcode_placeholder").hide(),a(".account_placeholder,.pwd_placeholder").show()):(k=/^(?:1[34578]\d{9})$/i,d.hide(),f.hide(),a(".captcha_wrapper").hide(),l=!1,e.val("").show().focus(),mcode.val("").show(),a(".getMobileCode").show(),a(".account_placeholder,.pwd_placeholder").hide(),a(".mcode_placeholder").length||(b.simulatePlaceholder(e,"mcode_placeholder",z.rootElement),b.simulatePlaceholder(mcode,"m_account_placeholder",a(".login_inputb",z.rootElement))),a(".m_account_placeholder,.mcode_placeholder").show())}).delegate(".getMobileCode","click",function(){var b,c=0,d=e.val(),f=a(this);return/^\s*$/.test(d)?(i.html("手机号码不能为空"),void e.focus()):k.test(d)?(a.getScript("//"+"reg.lenovo.com.cn"+"/captcha/canSend?mobile="+d+"&callback=getMobileCode",function(){mcode.focus()}),a(this).attr("disabled","disabled").html("60秒后重新获取"),void(b=setInterval(function(){60==c?(clearInterval(b),f.removeAttr("disabled").html("获取动态密码")):(f.html(60-c+"秒后重新获取"),c++)},1e3))):(i.html("手机号码格式错误"),void e.focus())}).delegate(".account","keydown",function(b){var c=b.keyCode,d=a(this).val();13!=c&&9!=c||(b.preventDefault(),/^\s*$/.test(d)?(i.html("账号不能为空"),a(this).focus()):k.test(d)?(i.html(""),f.focus()):(i.html("账号格式错误"),a(this).focus()))}).delegate(".m_account","keydown",function(b){var c=b.keyCode,d=a(this).val();13!=c&&9!=c||(b.preventDefault(),/^\s*$/.test(d)?(i.html("手机号码不能为空"),a(this).focus()):k.test(d)?(i.html(""),mcode.focus()):(i.html("手机号码格式有误"),a(this).focus()))}).delegate(".pwd","focus",function(){var a=d.val();/^\s*$/.test(a)?(i.html("账号不能为空"),d.focus()):k.test(a)||(i.html("账号格式错误"),d.focus())}).delegate(".mcode","focus",function(){var a=e.val();/^\s*$/.test(a)?(i.html("手机号码不能为空"),e.focus()):k.test(a)?i.html(""):(i.html("手机号码格式有误"),e.focus())}).delegate(".pwd,.mcode","keydown",function(a){var b=a.keyCode;13==b&&(l?g.focus():(a.preventDefault(),z.doLogin()))}).delegate(".captcha","keyup",function(a){var b=a.keyCode;13==b&&(a.preventDefault(),z.doLogin())}).delegate(".captcha","blur",function(a){var b=g.val();/^\s*$/.test(b)?i.html("请输入验证码"):/^[0-9a-zA-Z]{4}$/.test(b)||i.html("验证码格式错误")}).delegate(".captcha_img,.captcha_tip","click",function(){h.attr("src","//"+"captcha.lenovo.com.cn"+"/img?"+(new Date).getTime())}).delegate(".submit","click",function(a){a.preventDefault(),z.doLogin()}).delegate(".close","click",function(a){z.hide(),l=!1})},t=function(){var e,m=z.rootElement.find(".persistent"),n=d.val(),o=f.val();if(e=m.length?m[0].checked?"1":"0":1,/^\s+$/.test(n))return i.html("账号不能为空"),void d.focus();if(!k.test(n))return i.html("账号格式错误"),void d.focus();if(/^\s*$/.test(o))return i.html("密码不能为空"),void f.focus();if(o.length<4)return i.html("密码不得小于4位"),void f.focus();if(l){var p=g.val();if(/^\s*$/.test(p))return i.html("请输入验证码"),void g.focus();if(!/^[0-9a-zA-Z]{4}$/.test(p))return i.html("验证码格式错误"),void g.focus()}var q={account:n,password:o,ps:e,ticket:z.ticket,piccode:p},r=z.options||{};a.each(r,function(a,b){q[a]=b}),i.html("正在登录，请稍候... ..."),d.attr("disabled","disabled"),f.attr("disabled","disabled"),j.attr("disabled","disabled"),b.simulateFormSubmit("https://reg.lenovo.com.cn"+"/auth/v3/dologin",q,function(e){var g=e.ret,k=b.getDomain(z.loginRedirect||document.URL);if(d.removeAttr("disabled"),f.removeAttr("disabled"),j.removeAttr("disabled"),"0"==g){c.lidlogin(e.tgt,d.val());var m=encodeURIComponent(e["cerpreg-passport"]);/lenovo\.com\.cn|lenovouat\.cn/.test(k)?(b.cookie.set("ar","2",null,"."+k),v(m)):a.getScript("//reg."+k+"/auth/set_cookie?cookie="+m+"&domain="+k+"&ar=2",function(){v(m)})}else{if("验证码错误"!=e.msg&&"帐号或密码错误"!=e.msg||h.attr("src","//"+"captcha.lenovo.com.cn"+"/img?"+(new Date).getTime()),i.html(e.msg),f.focus(),l)return;var n=e.isshowpic;"false"==n&&(l=!0,h.attr("src","//"+"captcha.lenovo.com.cn"+"/img"),a(".captcha_wrapper").show())}},function(){d.removeAttr("disabled").focus(),f.removeAttr("disabled"),j.removeAttr("disabled"),i.html("登录超时，请稍后重试")})},u=function(){var b,c=z.rootElement.find(".persistent"),f=e.val(),g=mcode.val();return b=c.length?c[0].checked?"1":"0":1,/^\s+$/.test(f)?(i.html("手机号码不能为空"),void e.focus()):k.test(f)?/^\s*$/.test(g)?(i.html("动态验证码不能为空"),void mcode.focus()):(i.html(""),d.attr("disabled","disabled"),mcode.attr("disabled","disabled"),j.attr("disabled","disabled"),void a.getScript("https://reg.lenovo.com.cn"+"/auth/v1/fastlogin?ticket="+z.ticket+"&account="+f+"&captcha="+g+"&ps="+b+"&callback=doFastLogin",function(){d.removeAttr("disabled"),mcode.removeAttr("disabled"),j.removeAttr("disabled")})):(i.html("手机号码格式有误"),void e.focus())},v=function(c){var d;(d=z.loginRedirect)?location.href=b.absolutizeURI(location.href,d):(a(".ppWrapper").remove(),a(".ppMask").hide(),m=0,p(),z.drawUserInfo&&z.drawUserInfo(),z.login&&z.login(),z.callbacks.fire(),x(c))},w=function(){var a=z.login&&z.login.toString(),b=z.logout&&z.logout.toString(),c=z.drawUserInfo&&z.drawUserInfo.toString(),d=/location\.href|reload\(/;return d.test(a)||d.test(b)||d.test(c)},x=function(b){var c="lenovovip.com.cn,thinkworld.com.cn".split(","),d=location.protocol||"http:",e=""==b?"clear_cookie?":"set_cookie?cookie="+b+"&";a.each(c,function(a,b){b!=document.domain&&((new Image).src=d+"//reg."+b+"/auth/"+e+"domain="+b)})},y=function(){var c=b.cookie.get("leid")||"",d="1.";if(0!=c.indexOf(d)){var e=document.createElement("iframe");e.style.cssText="display:none",e.src="//"+"reg.lenovo.com.cn"+"/auth/anonymous",a("body").append(e)}},z={ticket:null,cookie:null,options:null,loginRedirect:null,logoutRedirect:null,rootElement:null,drawLoginForm:null,drawUserInfo:null,login:null,logout:null,cssUrl:null,callbacks:a.Callbacks(),callbacks1:a.Callbacks(),addLoginCallback:function(a){a&&z.callbacks.add(a)},addLogoutCallback:function(a){a&&z.callbacks1.add(a)},isLogin:function(){if(p(),this.cookie&&""!=this.cookie.lenovoId)return!0;var c=b.cookie.get("sce");return c||(b.cookie.set("sce","1"),a.getScript("//passport.lenovo.com/wauthen2/synCookie.jhtml?lenovoid_realm=shop.lenovo.com.cn",function(){b.cookie.remove("sce")})),!1},show:function(){var c=function(){k=/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i,l=!1,a("#ppMask").show(),z.rootElement.show(),a("h3[type=0]",z.rootElement).trigger("click"),a(".account_placeholder").length||(b.simulatePlaceholder(d,"account_placeholder",z.rootElement),b.simulatePlaceholder(f,"pwd_placeholder",a(".login_inputb",z.rootElement)))};z.rootElement&&c();var e=setInterval(function(){z.rootElement&&(clearInterval(e),c())},50)},hide:function(){d.val(""),e.val(""),f.val(""),i.val(""),m=0,a(".account_placeholder,.pwd_placeholder,.mcode_placeholder").hide(),a("#ppMask").hide(),z.rootElement.hide()},init:function(c){return z.ticket?void n(1):void a(function(){var a=c.ticket,d=c.drawUserInfo;if(!a)return void n(2);if(z.ticket=a,z.loginRedirect=c.loginRedirect||z.loginRedirect||null,z.logoutRedirect=c.logoutRedirect||z.logoutRedirect||null,z.drawUserInfo=d||null,z.login=c.login||null,z.logout=c.logout||null,z.cssUrl=c.cssUrl||null,w())return void n(3);if(z.options=c.options,o(),z.isLogin())d&&z.drawUserInfo();else{var e=c.drawLoginForm;b.loadCSS(z.cssUrl||"//m1.lefile.cn/lenovo_passport/0.4.9/css/pr.min.css",function(){if(e){var a=c.rootElement;if(!a)return void n(2);z.rootElement=a,z.drawLoginForm=e,e()}else q();s(),r()})}})},doLogin:function(){"0"==m?t():u()},doLogout:function(){var d=b.getDomain(z.logoutRedirect||document.URL),e=location.protocol||"http:";c.lidlogout(z.cookie.loginName),a.getScript(e+"//reg."+d+"/auth/clear_cookie?domain="+d+"&ar=2",function(){if(z.logoutRedirect){var a=z.logoutRedirect;location.href=b.absolutizeURI(location.href,a)}else b.loadCSS(z.cssUrl||"//m1.lefile.cn/lenovo_passport/0.4.9/css/pr.min.css",function(){z.cookie=!1,z.drawLoginForm?z.drawLoginForm():q(),z.rootElement.hide(),s(),r(),z.logout&&z.logout(),z.callbacks1.fire(),x(""),"lenovo.com.cn"!=d&&((new Image).src=e+"//reg.lenovo.com.cn/auth/clear_cookie?domain=lenovo.com.cn")})})},load:function(a){a&&a()},sync:function(c,d,e,f,g,h){a.ajax({url:"//reg.lenovo.com.cn/auth/synck/dologin",dataType:"jsonp",data:{ts:c,tk:d,rm:e},success:function(a,c){if(0!=a.ret)f&&f(a,c);else{var d=a["cerp-passport"];b.cookie.set("cerp-passport",d),g&&g(a,c),x(d)}},error:function(a,b,c){h&&h(b,c)}})}},A=document.URL;if(b.cookie.get("ar")&&/[^\?&]+(lenovo(?:vip|uat)?|thinkworldshop|thinkworld)\./.test(A)){var B=b.cookie.get("cerpreg-passport")||"";x(encodeURIComponent(B)),b.cookie.remove("ar",b.getDomain(document.URL))}return setTimeout(function(){y()},1e3),a(function(){b.loadJS("//"+"reg.lenovo.com.cn"+"/mt/cc?"+(new Date).getTime())}),z.loginAction=v,z}),function(a){var b=Util,c=LenovoId;a(function(){var d=(document.body.scrollWidth,document.body.scrollHeight);0==d&&(d=document.documentElement.scrollHeight);var e,f,g,h,i,j,k,l,m,n,o,p,q,r="http://"+"reg.lenovo.com.cn",s=/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i,t=/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?\.>\-\=\+<\(\),\[\];:\/]+)$)^[\w~!@#$%^&*?\.>\-\=\+<\(\),\[\];:\/]{8,20}$/,u=function(){h.hide(),g.hide(),a(".rr_account_placeholder").length&&(a(".rr_account_placeholder").remove(),a(".rr_pwd_placeholder").remove())},v='<div class="enroll"> <div class="enroll_title"> <h1>欢迎注册联想会员</h1> <a class="close" href="javascript:void(0)" latag="latag_pc_register_boxclose" style="text-decoration:none;"></a></div> <div class="enroll_inputa"> <p><label>账号</label><input class="account" type="text" data-placeholder="请输入手机号或邮箱"></p> </div> <div class="enroll_inputaa errorAccount"></div> <div class="enroll_inputb"> <p><label>密码</label><input data-placeholder="密码长度8~20位,数字、字母、字符至少包含两种" class="pwd" type="password"/></p> </div> <div class="enroll_inputaa errorPwd"></div> <div class="enroll_inputc"> <p><label>确认密码</label><input type="password" class="repwd"></p> </div> <div class="enroll_inputaa errorRepwd"></div> <div class="enroll_inputd"> <p><label>验证码</label><input type="text" class="captcha"></p><img class="img_captcha" latag="latag_pc_register_verificationcode"/><span class="img_captcha_tip" latag="latag_pc_register_verificationcode">换一张</span><button class="mobile_captcha" style="display:none;">获取验证码</button></div> <div class="enroll_inputaa errorCaptcha"></div> <div class="enroll_main"><label> <input type="checkbox" class="chk" checked><p style="color: #000"> 同意联想的 <a target="_blank" href="http://appserver.lenovo.com.cn/Public/public_bottom/legal.shtml" style="color: #005ce6;" latag="latag_pc_register_privacy">使用条款</a> 和 <a target="_blank" href="http://appserver.lenovo.com.cn/Public/public_bottom/privacy.shtml" style="color: #005ce6;" latag="latag_pc_register_privacy">隐私权政策</a> </p></label> </div> <div class="enroll_btn"> <a  style="text-decoration:none;" class="submit" href="javascript:void(0)" latag="latag_pc_register_confirm">立即注册</a> </div> </div>',w='<div class="password_one" style="left:0;top:0;background:#fff"> <div class="password_titles"> <p><span>找回密码</span>&nbsp;&nbsp;&gt;&gt;第一步</p>  <a class="close" href="javascript:void(0)"></a></div> <div class="password_inputa"> <p>账号：<input class="account" type="text" data-placeholder="请输入手机或邮箱"></p> </div> <div class="enroll_inputaa errorAccount recoverError"> </div> <div class="password_inputb"> <p>验证码：<input class="captcha" type="text"></p><img class="img_captcha" /><span class="img_captcha_tip">换一张</span><button class="mobile_captcha" style="display: none;">获取验证码</button></div> <div class="enroll_inputaa errorCaptcha recoverError"> </div> <div class="password_btns"> <a href="javascript:void(0)" class="submit">下一步</a> </div> </div><div class="password_two" style="left:0;top:0;background:#fff;display: none;"> <div class="password_title"> <p><span>找回密码</span>&nbsp;&nbsp;&gt;&gt;第二步</p> <a class="close" href="javascript:void(0)">x</a></div> <div class="password_cont"> <img src="//m1.lefile.cn/lenovo_passport/0.4.9/images/icon01.png"> <h1></h1> </div> <div class="password_btn"> <a href="javascript:void(0)">进入邮箱</a> </div> <div class="password_main"> <p>请您注意接收信息，并按照信息中的提示操作，完成安全验证。</p> </div> </div>',x={error:function(b){switch(b){case"0":a(".errorAccount").html('<p class="error">请输入正确格式的帐号</p>');break;case"1":a(".errorPwd").html('<p class="error">密码长度8-20位</p>');break;case"2":a(".errorPwd").html('<p class="error">密码至少包含数字、字母、字符其中的2种</p>');break;case"3":a(".errorRepwd").html('<p class="error">确认密码和密码不一致，请重新输入</p>');break;case"4":a(".errorCaptcha").html('<p class="error">输入的验证码不对，请重新输入</p>');break;case"5":a(".errorCaptcha").html('<p class="error">输入的验证码过期，请重新获取</p>');break;case"6":a(".errorAccount").html('<p class="error">账号已存在</p>');break;case"7":a(".errorAccount").html('<p class="error">账号不存在</p>');break;case"8":a(".errorAccount").html('<p class="error">帐号不能为空</p>');break;case"9":a(".errorCaptcha").html('<p class="error">验证码不能为空</p>');break;case"10":a(".errorPwd").html('<p class="error">密码不能为空</p>')}},account:function(b){var c=i.val();return/^\s*$/.test(c)?void x.error("8"):s.test(c)?("recover"==b?a.getScript(r+"/auth/validateAccount?account="+c+"&callback=response.authAccountRecover"):a.getScript(r+"/auth/validateAccount?account="+c+"&callback=response.authAccount"),void a(".errorAccount").html("")):void x.error("0")},pwd:function(){var b=j.val();return/^\s*$/.test(b)?void x.error("10"):b.length<8||b.length>20?void x.error("1"):t.test(b)?void a(".errorPwd").html(""):void x.error("2")},repwd:function(){var b=j.val(),c=k.val();return b!=c?void x.error("3"):void a(".errorRepwd").html("")},captcha:function(){var b=o.val();return/^\s*$/.test(b)?(x.error("9"),!1):(a(".errorCaptcha").html(""),!0)},validate:function(){return this.account(),this.pwd(),this.repwd(),this.captcha(),g.find(".chk")[0].checked?!g.find(".error").length:(a(".errorCaptcha").html("<p>请确认已阅读相关协议政策</p>"),!1)},validateRecover:function(){return this.account("recover"),this.captcha(),!g.find(".error").length}},y={getPicCode:function(){var b=i.val();a.getScript(r+"/captcha/pic/show?mobile="+b+"&callback=response.getEmailCaptCode")},getMobileCodeForRegist:function(){f=0,clearInterval(e),n.removeAttr("disabled").html("获取验证码"),z()},getMobileCodeForRecover:function(){f=0,clearInterval(e),n.removeAttr("disabled").html("获取验证码"),z("c")}},z=function(b){var c=i.val(),d=1;/^\s*$/.test(c)||B.isDefault&&a(".errorAccount .error").length||g.find(".tip .error").length||"disabled"!=n.attr("disabled")&&(b?a.getScript(r+"/captcha/mobile/show?kbn=0&mobile="+c+"&callback=response.getMobileCaptCode"):a.getScript(r+"/captcha/mobile/show?mobile="+c+"&callback=response.getMobileCaptCode"),n.attr("disabled","disabled").html("60秒后重新获取"),e=setInterval(function(){60==d?(clearInterval(e),n.removeAttr("disabled").html("获取验证码")):(n.html(60-d+"秒后重新获取"),d++)},1e3))},A={authAccount:function(a){if("1"==a)x.error("6"),n.hide(),l.show(),m.show();else{var b=i.val();/^\d{11}$/.test(b)?(l.hide(),m.hide(),n.show()):(n.hide(),l.show(),m.show())}},authAccountRecover:function(b){var c=i.val();"0"==b?x.error("7"):/^\d{11}$/.test(c)?(a(".img_captcha,.img_captcha_tip").hide(),a(".mobile_captcha").show()):(a(".mobile_captcha").hide(),a(".img_captcha,.img_captcha_tip").show());
},getEmailCaptCode:function(a){var b="data:image/png;base64,"+a;l.attr("src",b)},getMobileCaptCode:function(b){"0"!=b.ret&&a(".errorCaptcha").html("<p>"+b.msg+"</p>")}},B={submit:function(){var d={account:i.val(),password:j.val(),captcha:o.val(),ticket:p};x.validate()&&(i.attr("disabled","disabled"),j.attr("disabled","disabled"),k.attr("disabled","disabled"),o.attr("disabled","disabled"),q.attr("disabled","disabled"),a(".errorCaptcha").html('<p class="error">正在注册，请稍后...</p>'),b.simulateFormSubmit("https://reg.lenovo.com.cn"+"/auth/v3/doregist",d,function(d){var e=d.ret,f=b.getDomain(passport.loginRedirect||document.URL);if(i.removeAttr("disabled"),j.removeAttr("disabled"),k.removeAttr("disabled"),o.removeAttr("disabled"),q.removeAttr("disabled"),"0"==e){c.lidlogin(d.tgt,i.val());var g=encodeURIComponent(d["cerpreg-passport"]);/lenovo\.com\.cn|lenovouat\.cn/.test(f)?(u(),passport.loginAction(g)):a.getScript("http://reg."+f+"/auth/set_cookie?cookie="+g+"&domain="+f,function(){u(),passport.loginAction(g)})}else x.error(d.errcode)},function(){i.removeAttr("disabled"),j.removeAttr("disabled"),k.removeAttr("disabled"),o.removeAttr("disabled"),q.removeAttr("disabled"),a(".errorCaptcha").html('<p class="error">注册超时,请稍后重试</p>')}))},init:function(c){if(p="string"==typeof c?c:c.ticket,!p)throw new Error("缺少ticket");a("#ppInfo").length||a("body").append('<div id="ppInfo" class="ppInfo"></div>'),g=a("#ppInfo"),h=a("#ppMask"),g.css("width","429px"),g.html(v),h.show(),g.show();var d=g.find(".close");d.on("click",u),i=g.find(".account"),j=g.find(".pwd"),k=g.find(".repwd"),o=g.find(".captcha"),l=g.find(".img_captcha"),m=g.find(".img_captcha_tip"),n=g.find(".mobile_captcha"),q=g.find(".submit"),f=0,clearInterval(e),n.removeAttr("disabled").html("获取验证码"),y.getPicCode(),i.focus(),b.simulatePlaceholder(i,"rr_account_placeholder",g),b.simulatePlaceholder(j,"rr_pwd_placeholder",g),i.on("blur",x.account),j.on("blur",x.pwd),k.on("blur",x.repwd),l.on("click",y.getPicCode),m.on("click",y.getPicCode),n.on("click",y.getMobileCodeForRegist),o.on("keyup",function(a){var b=a.keyCode;13==b&&B.submit()}),q.on("click",B.submit)},hide:function(){u()}},C={submit:function(){var b=a("#ppInfo .account").val(),c=a("#ppInfo .captcha").val();x.validateRecover()&&a.getScript(r+"/pwd/findPassword?account="+b+"&captcha="+c+"&callback=recover.submitResponse")},submitResponse:function(b){var c=b.ret,d=a("#ppInfo .account").val();if(0==c){if(a(".password_one").hide(),g.css("marginLeft","-465px"),/^\d{11}$/.test(d))a(".password_cont h1").html("恭喜您，重置链接已经发送到您的手机，点击短信中的连接进行密码重置"),a(".password_btn").hide();else{var e="http://mail."+d.split("@")[1];a(".password_cont h1").html("恭喜您，重置链接已经发送到您的"+d+"邮箱，点击邮箱中的连接进行密码重置"),a(".password_btn a").attr("href",e)}g.css("width","930"),a(".password_two").show()}else x.error(b.errcode)},init:function(){a("#ppInfo").length||a("body").append('<div id="ppInfo" class="ppInfo"></div>'),g=a("#ppInfo"),h=a("#ppMask"),g.css("width","460px"),g.html(w),h.show(),g.show(),i=g.find(".account"),o=g.find(".captcha"),l=g.find(".img_captcha"),m=g.find(".img_captcha_tip"),n=g.find(".mobile_captcha").removeAttr("disabled").html("获取验证码"),f=0,clearInterval(e),y.getPicCode(),setTimeout(function(){i.focus()},500),i.on("blur",function(){x.account("recover")}),l.on("click",y.getPicCode),m.on("click",y.getPicCode),n.on("click",y.getMobileCodeForRecover),o.on("keyup",function(a){var b=a.keyCode;13==b&&C.submit()}),g.find(".submit").on("click",C.submit);var b=g.find(".close");b.on("click",u)},hide:function(){u()}};window.regist=B,window.recover=C,window.response=A})}(jQuery);