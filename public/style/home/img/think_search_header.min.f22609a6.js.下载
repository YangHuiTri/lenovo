function getQueryString(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),c=window.location.search.substr(1).match(b);return null!=c?decodeURIComponent(c[2]):""}function getLeid(){for(var a="",b=document.cookie.split(";"),c=0;c<b.length;c++)if("leid"==b[c].split("=")[0].trim()){a=b[c].split("=")[1];break}return a}function autoAjax(a,b){$.ajax({url:tmp_search_url+"/search/suggest?kw="+encodeURIComponent($(".think_search_header input[type=text]").val())+"&plat=4&leid="+getLeid(),type:"GET",jsonp:"cb",dataType:"jsonp",success:function(a){if("1"!=a.rc){var c=["<ul>"];if(0==a.s.length)return void b.suggest.html("").hide();b.suggest.html("");for(var d=a.s,e=0;e<d.length;e++)"cate"==d[e].type?c.push("<li title='"+d[e].word+"'><a href='"+tmp_search_url+"?index="+d[e].code+"&key="+d[e].word+"'>"+d[e].word+"</a></li>"):"goods"==d[e].type?c.push("<li title='"+d[e].word+"'><a href='"+tmp_search_detail+d[e].code+".html'>"+d[e].word+"</a></li>"):"1"==d[e].his?getQueryString("index")?c.push("<li title='"+d[e].word+"'><a style='float: left;' href='"+tmp_search_url+"?index="+getQueryString("index")+"&key="+d[e].word+"'>"+d[e].word+"</a><a style='float:right;margin-right: 13px;' word='"+d[e].word+"' tag='del'>删除历史</a></li>"):c.push("<li title='"+d[e].word+"'><a style='float: left;' href='"+tmp_search_url+"?key="+d[e].word+"'>"+d[e].word+"</a><a style='float:right;margin-right: 13px;' word='"+d[e].word+"' tag='del'>删除历史</a></li>"):getQueryString("index")?c.push("<li title='"+d[e].word+"'><a href='"+tmp_search_url+"?index="+getQueryString("index")+"&key="+d[e].word+"'>"+d[e].word+"</a></li>"):c.push("<li title='"+d[e].word+"'><a href='"+tmp_search_url+"?key="+d[e].word+"'>"+d[e].word+"</a></li>");c.push("</ul>"),b.suggest.html(c.join("")).show()}}})}function getItemsInAutoCompletedList(a){var b=null;return $("#suggestContainer a").each(function(){if($(this).text().trim().toLowerCase()==a.trim().toLowerCase())return b=$(this),!1}),b}var tmp_new_search_url="http://s.lenovo.com.cn",tmp_search_url="http://s.lenovo.com.cn",tmp_search_detail="http://www.lenovo.com.cn/product/";String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var ITO;$(function(){$("body").delegate(".think_search_header .usepng","click",function(){var a=$(this).prev().val(),b=getItemsInAutoCompletedList(a),c=getQueryString("index");""==a&&(c=-1),b?window.location.href=b.attr("href"):c>-1?window.location.href=tmp_new_search_url+"?key="+encodeURIComponent($(this).prev().val()):window.location.href=tmp_new_search_url+"?key="+encodeURIComponent($(this).prev().val())});var a=Class.create({setInputValue:function(){var a;this.current&&(a=this.current.attr("title")||this.current.text(),this.input.val(a))},focus:function(a){var b=this,c=$(".think_search_header input[type=text]").val();"ThinkPad X1"==c||""==c?($(".think_search_header input[type=text]").val(""),autoAjax("",b)):autoAjax(c,b)},blur:function(){},click:function(a){var b=a.target;if("del"!=$(b).attr("tag"))return this.input.val($(b).parent().attr("title")),!0;a.stopPropagation();var c=$(b).attr("word");$.ajax({url:tmp_search_url+"/search/suggestDelete?kw="+encodeURIComponent(c)+"&plat=4&leid="+getLeid(),type:"GET",jsonp:"cb",dataType:"jsonp",success:function(a){"0"==a.rc&&$(b).parent().remove()}})}},AutoComplete);$("body").click(function(a){var b=$(a.target);"latag_pc_search_keyword"==b.attr("latag")||"del"==b.attr("tag")?$("#suggestContainer").show():$("#suggestContainer").hide()}),new a({input:$(".think_search_header input[type=text]"),suggest:$("#suggestContainer"),tip:getQueryString("key")?" ":"ThinkPad X1",getDatas:function(){var a=this,b=$(".think_search_header input[type=text]").val();autoAjax(b,a)},submit:function(){this.suggest.hide();var a=$(".think_search_header input[type=text]").val(),b=getItemsInAutoCompletedList(a),c=getQueryString("index");""==a&&(c=-1),this.current?window.location.href=this.current.find("a").attr("href"):b?window.location.href=b.attr("href"):c>-1?window.location.href=tmp_new_search_url+"?key="+encodeURIComponent(a):window.location.href=tmp_new_search_url+"?key="+encodeURIComponent(a)}})});